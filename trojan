＃！/ bin / bash
蓝色（）{
    echo -e“ \ 033 [34m \ 033 [01m $ 1 \ 033 [0m]”
}
绿色（）{
    echo -e“ \ 033 [32m \ 033 [01m $ 1 \ 033 [0m]”
}
红色（）{
    echo -e“ \ 033 [31m \ 033 [01m $ 1 \ 033 [0m]”
}

如果[[-f / etc / redhat-release]]; 然后
    release =“ centos”
    systemPackage =“ yum”
    systempwd =“ / usr / lib / systemd / system /”
猫猫/ etc / issue | grep -Eqi“ debian”; 然后
    release =“ debian”
    systemPackage =“ apt-get”
    systempwd =“ / lib / systemd / system /”
猫猫/ etc / issue | grep -Eqi“ ubuntu”; 然后
    release =“ ubuntu”
    systemPackage =“ apt-get”
    systempwd =“ / lib / systemd / system /”
猫猫/ etc / issue | grep -Eqi“ centos | red hat | redhat”; 然后
    release =“ centos”
    systemPackage =“ yum”
    systempwd =“ / usr / lib / systemd / system /”
小精灵猫/ proc / version | grep -Eqi“ debian”; 然后
    release =“ debian”
    systemPackage =“ apt-get”
    systempwd =“ / lib / systemd / system /”
小精灵猫/ proc / version | grep -Eqi“ ubuntu”; 然后
    release =“ ubuntu”
    systemPackage =“ apt-get”
    systempwd =“ / lib / systemd / system /”
小精灵猫/ proc / version | grep -Eqi“ centos | red hat | redhat”; 然后
    release =“ centos”
    systemPackage =“ yum”
    systempwd =“ / usr / lib / systemd / system /”
科幻

明确
绿色“ ================================================ ==========
 蓝色“支持：centos7 + / debian9 + / ubuntu16.04 +”
蓝色的“ YouTube逍遥观世界””
 blue“本脚本禁止在国内网站转载”
绿色“ ================================================ ==========
  红色“简介：本脚本为Trojan分解安装第一部分（安装依赖环境和服务）”
绿色“ ================================================ ==========
阅读-s -n1 -p“如果同意上述协议，请按任意键继续...”
绿色 ” ”
如果cat / proc / version | grep -Eqi“ centos | red hat | redhat”; 然后
百胜安装epel-release
科幻
$ systemPackage更新
$ systemPackage -y安装sudo nginx wget解压缩zip curl tar
systemctl启用nginx
systemctl停止nginx
	绿色“ ======================”
	蓝色“请输入绑定到本VPS的域名”
	绿色“ ======================”
	阅读your_domain
	real_addr =`ping $ {your_domain} -c 1 | sed'1 {s / [^（] *（//; s /).*//; q}'``
	local_addr =`curl ipv4.icanhazip.com`
	绿色 ” ”
	绿色 ” ”
	绿色“ ==================================
	 蓝色“检测到域名解析地址为$ real_addr”
	 蓝色“本VPS的IP为$ local_addr”
	绿色“ ==================================
	睡眠3秒
如果[$ real_addr == $ local_addr]; 然后
	绿色 ” ”
	绿色 ” ”
	绿色“ ========================================
	蓝色“开始安装Nginx并配置”
	绿色“ ========================================
	睡眠3秒
猫> /etc/nginx/nginx.conf <<-EOF
用户root；
worker_processes 1;
error_log /var/log/nginx/error.log警告；
pid /var/run/nginx.pid;
事件{
    worker_connections 1024;
}
http {
    包括/etc/nginx/mime.types;
    default_type应用程序/八位字节流；
    log_format main'\ $ remote_addr-\ $ remote_user [\ $ time_local]“ \ $ request”'
                      '\ $ status \ $ body_bytes_sent“ \ $ http_referer”'
                      '“ \ $ http_user_agent”“ \ $ http_x_forwarded_for”“;
    access_log /var/log/nginx/access.log main;
    发送文件
    #tcp_nopush on;
    keepalive_timeout 120;
    client_max_body_size 20m;
    #gzip on;
    服务器{
        听80;
        server_name $ your_domain;
        根目录/ usr / share / nginx / html;
        index index.php index.html index.htm;
    }
}
紧急行动
	绿色 ” ”
	绿色 ” ”
	绿色“ ========================================
	蓝色“开始下载伪装站点源码并部​​署”
	绿色“ ========================================
	睡眠3秒
	rm -rf / usr / share / nginx / html / *
	cd / usr / share / nginx / html /
	wget https://github.com/V2RaySSR/Trojan/raw/master/web.zip
	解压web.zip
	systemctl重启nginx
	绿色“ ========================================
	blue“开始下载安装官方Trojan最新版本”
	绿色“ ========================================
	睡眠3秒
	sudo bash -c“ $（wget -O- https://raw.githubusercontent.com/trojan-gfw/trojan-quickstart/master/trojan-quickstart.sh）”
	systemctl enable木马
	绿色“ ================================================ ========“
	蓝色“本次脚本安装完成，现在进行检测”
	绿色“ ================================================ ========“
	阅读-s -n1 -p“现在开始检测安装情况，请按任意键继续...”
	绿色 ” ”
如果测试-s /etc/nginx/nginx.conf; 然后
	绿色 ” ”
	绿色 ” ”
	绿色“ ==========================”
	 蓝色“ Nginx安装正常”
	绿色“ ==========================”
	睡眠3秒
其他
	绿色 ” ”
	绿色 ” ”
	绿色“ ==========================”
	  红色“ Nginx安装不成功”
	绿色“ ==========================”
	睡眠3秒
科幻
如果测试-s /usr/local/etc/trojan/config.json; 然后
	绿色 ” ”
	绿色 ” ”
	绿色“ ==========================”
	 蓝色的“ Trojan安装正常”
	绿色“ ==========================”
	睡眠3秒
其他
	绿色 ” ”
	绿色 ” ”
	绿色“ ==========================”
	  红色“ Trojan安装不成功”
	绿色“ ==========================”
	睡眠3秒
科幻
	绿色 ” ”
	绿色 ” ”
	绿色“ ================================================ ========“
	 蓝色“本过程安装了sudo / nginx / wget / unzip / zip / curl / tar / trojan”
	 blue“现在您访问http：// $ your_domain应该有伪装站点的存在了”
	 蓝色“伪装站点目录在/ usr / share / nginx / html可自行更换网站”
	 蓝色“ Trojan配置文件在/ usr / local / etc / trojan”
	 blue“检测没有问题之后可以进行下一部分安装”
	绿色“ ================================================ ========“
其他
	绿色 ” ”
	绿色 ” ”
	红色“ ===============================”
	红色“域名解析地址与本VPS IP地址替代”
	红色“本次安装失败，请确保域名解析正常”
	红色“ ===============================”
科幻
